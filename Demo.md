# DEMO DE PENTESTING

En esta demo se muestra como hacer un pentesting hacia la maquina Metasploitable3 que es una maquina Windows que tiene muchas vulnerabilidades. 

# Enumeración

Vamos a empezar primero haciendo un escaneo a la red con NMAP, la cual es una herramienta de escaneo de red que se utiliza para descubrir hosts y servicios en una red. Es una herramienta muy útil para los profesionales de la seguridad informática, ya que les permite identificar vulnerabilidades y realizar pruebas de penetración en los sistemas.

Una vez que se identifican los hosts, NMAP puede realizar una serie de pruebas para identificar los servicios que se ejecutan en esos hosts y determinar si hay algún tipo de vulnerabilidad que pueda ser explotada.

Empezamos identificando los hosts de nuestra red, como se llega a apreciar justamente con el siguiente comando:

```bash
sudo nmap 192.168.125.0/24
```

Logramos ver e identificar nuestra maquina Metasploitable3 con el comando anterior 

![Untitled](/assets/img/Untitled.png)

# PENTESTING

Una vez tengamos la IP de la maquina podremos pasar a explotarla, para ello utilizaremos Metasploit la cual es una herramienta de prueba de penetración de código abierto que se utiliza para identificar, penetrar vulnerabilidades en sistemas y redes informáticas.

Para poder utilizar Metasploit, ejecutaremos el comando que vemos a continuación como sudo y con ello estaremos dentro de Metasploit

```bash
sudo msfconsole
```

![Untitled](/assets/img/Untitled%201.png)

De primeras una vez sacados los servicios y puertos que tiene la maquina abierta, vamos a pasar a intentar penetrar el MySQL, así que con la ayuda de metasploit vamos a buscar un modulo llamado mysql_login, si buscamos en la terminal, podemos encontrarlo poniendo “search mysql”.

```bash
search mysql
```

![Captura.PNG](/assets/img/Captura.png)

Aquí apreciamos donde se encuentra el modulo de mysql_login, por tanto tendremos que seleccionarlo. Para seleccionar el modulo que queremos tenemos dos formas de hacerlo:

1. Seleccionando el numero del modulo en cuestión al hacer “search”.
    
    ```bash
    use 17
    ```
    
2. Seleccionando manualmente el modulo (Puede llegar a ser mas rápido si sabes cual es el modulo).
    
    ```bash
    use auxiliary/scanner/mysql/mysql_login
    ```
    

Después si pones options, nos aparecerá la distintas opciones que podríamos configurar, en este caso, la única opción que vamos a configurar y a modificar es el RHOST.

Para modificarla es muy sencillo, lo único que tendríamos que poner seria:

```bash
set rhosts (La IP de vuestra maquina windowsm metasploit)
```

![Untitled](/assets/img/Untitled%202.png)

Y ya solo poniendo “run” arrancara el modulo.  Como podemos apreciar en la imagen nos saca que el usuario root por defecto y al parecer tiene una contraseña vacía.

![Untitled](/assets/img/Untitled%203.png)

# Post-Explotación

Ya después de haber explotado la maquina y sacado las credenciales del servicio MySQL, tendríamos vía libre por la base de datos.

Si queremos conectarnos al MySQL de la maquina únicamente tendríamos que ejecutar el siguiente comando:

```bash
	mysql -u root -p -h (IP)
```

Ya una vez dentro del MySQL, podemos ver las base de datos de MySQL. Como podemos apreciar, la que mas nos puede interesar es la base de datos del Wordpress, ya que en esa base de datos se guardan todos los datos del Wordpress. 

![Untitled](/assets/img/Untitled%204.png)

Con el comando siguiente pasamos a utilizar la base de datos de Wordpress para poder llegar a ver todas las tablas:

```bash
 use  Wordpress
```

![Untitled](/assets/img/Untitled%205.png)

Para poder ver las tablas, es tan simple como poner:

```bash
show tables;
```

![Untitled](/assets/img/Untitled%206.png)

En nuestro caso la que mas nos puede llamar mas la atención es la que se llama “wp_users” ya que aquí se guardan los usuarios y las contraseñas de Wordpress. Como podemos llegar a ver, vemos los usuarios admin, vagrant, user y manager, los cuales tienen una contraseñas hasheada.

![Untitled](/assets/img/Untitled%207.png)

Normalmente en el campo user_pass, es donde se guarda la contraseña del Wordpress, pero la cosa es que están hasheadas. Lo que vamos a hacer es sustituir la contraseña por una nueva. Como podemos apreciar en la imagen de abajo, lo que vamos a hacer es actualizar la tabla wp_users y vamos a cambiar el campo user_pass por la contraseña 1234 que va a estar hasheada en md5.

![Untitled](/assets/img/Untitled%208.png)

Cuando hayamos cambiado la contraseña para poder comprobar que todo salió correctamente, nos iremos a nuestro navegador, desde la máquina en la cual estemos atacando y escribiremos lo siguiente en el buscador:

```bash
(IP):8585/wordpress/wp-admin
```

Esto nos llevara a la pagina de Wordpress alojado en la maquina atacada en el puerto “8585”.

Después de haber sustituido la contraseña, como podemos ver hemos podido acceder al Wordpress con usuario:admin y contraseña:1234.

![Untitled](/assets/img/Untitled%209.png)

![Untitled](/assets/img/Untitled%2010.png)

Algunas posibles consecuencias de un acceso no autorizado a un sitio de WordPress incluyen:

- Modificación del contenido: El atacante podría alterar el contenido del sitio web, eliminando, agregando o modificando información. Esto podría incluir publicar contenido malicioso o inapropiado que pueda dañar la reputación del sitio web.
- Robo de información: Si el sitio web recopila información de los usuarios, como nombres, direcciones de correo electrónico o información de pago, el atacante podría acceder a esta información y utilizarla para fines malintencionados, como el robo de identidad o el fraude financiero.
- Instalación de malware: El atacante podría utilizar el acceso al sitio web para instalar malware en el servidor, lo que podría comprometer la seguridad del sitio web y de sus usuarios.
- Pérdida de datos: Si el atacante tiene acceso a los sistemas de almacenamiento de datos del sitio web, podría eliminar o modificar la información almacenada, lo que podría causar pérdida de datos o errores en el funcionamiento del sitio web.
- Estas son algunas, pero también existen muchas mas.